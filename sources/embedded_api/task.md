本API用于描述系统和任务(Task)的操作方法。

嵌入式系统中经常需要对一个任务进行调度，如延迟100ms后点亮一盏灯，或是每隔2秒钟读取一次传感器，或是一个任务在系统空闲时运行。SDK对这些任务调度的操作进行了封装。

> 如无特殊说明，本系列API同时兼容nRF51平台和STM32平台。

***
## 数据结构
### 任务的定义
任务(Task)定义为一个函数的函数指针：
 
```
	typedef void (*function_t)(void* args);
```  


***
## 系统就绪事件
###1. 函数声明
```
void on_ready(void);
```

###2. 函数功能
当系统就绪后触发该事件。  
用户在该函数内部开始构建自己的应用程序。

###3. 函数参数
参数    | 数据类型   | 说明
:----- | :-------- | :------
*返回值*  | void      | 无

###4. 函数举例
```
	...
	void on_ready()
	{
		BSP_LED_On(LED0); //点亮LED0
	}
	...
```

***
## 获取当前时间
###1. 函数声明
```
uint32_t current_time(void);
```

###2. 函数功能
获取当前时间。

###3. 函数参数
参数    | 数据类型   | 说明
:----- | :-------- | :------
*返回值*  | uint32_t | 当前的时间值，单位为毫秒(ms)。

***
## 预定时间运行
###1. 函数声明
```
void run_at_time(function_t func, void* args, uint32_t time);
```

###2. 函数功能
向系统注册一个在指定的时间点上运行的函数。


###3. 函数参数
参数    | 数据类型   | 说明
:----- | :-------- | :------
*func*|function_t|要执行的[函数](#_1)(函数指针)
*args*|void * |执行函数时传入的参数(只能是一个指针)
*time*|uint32_t|函数执行的时间点
*返回值*  | void      | 无

###4. 函数举例
```
	void led_on_task(void* args)
	{
		...
	}

	//当前函数
	void foo()
	{
		...
		//调用本函数向系统注册一个在指定时间点上会被执行的任务
		run_at_time(led_on_task, NULL, current_time() + 100)；//100ms后运行。
		...
	}
```

***
## 延迟运行
###1. 函数声明
```
void run_after_delay(func, args, delay);
```


###2. 函数功能
向系统注册一个在一段时间后运行的函数。


###3. 函数参数
参数    | 数据类型   | 说明
:----- | :-------- | :------
*func*|function_t|要执行的[函数](#_1)(函数指针)
*args*|void * |执行函数时传入的参数(只能是一个指针)
*delay*|uint32_t|函数执行的延迟时间
*返回值*  | void      | 无


###4. 函数举例
```
	//写一个需要运行的函数
	void led_on_task(void* args)
	{
		...
	}

	//当前函数
	void foo()
	{
		...
		//调用本函数向系统注册一个在系统空闲时会被执行的任务
		run_after_delay(led_on_task, NULL, 250)；//250ms后运行。
		...
	}
```

***
## 空闲时运行
###1. 函数声明
```
void run_when_idle(function_t func, void* args);
```


###2. 函数功能
向系统注册一个在系统空闲的时候运行的函数。  
通常，这种被执行的函数对时间要求不高。

###3. 函数参数
参数    | 数据类型   | 说明
:----- | :-------- | :------
*func*|function_t|要执行的[函数](#_1)(函数指针)
*args*|void * |执行函数时传入的参数(只能是一个指针)
*返回值*  | void      | 无

###4. 函数举例
```	
	void led_on_task(void* args)
	{
		// Pull Up
		gpio_write(LED_1, 1);
		run_after_delay(led_off_task, NULL, 250);
	}

	//当前函数
	
	void foo()
	{
		...
		//调用本函数向系统注册一个在系统空闲时会被执行的任务
		run_when_idle(led_on_task, NULL);	
		...
	}
```




